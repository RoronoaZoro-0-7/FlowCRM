module.exports=[70604,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(48078),e=a.i(3130),f=a.i(40695),g=a.i(15618),h=a.i(38422),i=a.i(4667),j=a.i(50944),k=a.i(74808),l=a.i(88237),m=a.i(76504),n=a.i(87682),o=a.i(54161),p=a.i(50463),q=a.i(7706),r=a.i(5522),s=a.i(17755),t=a.i(10448),u=a.i(81560),v=a.i(77156),w=a.i(87532),x=a.i(81464),y=a.i(23292);let z={OWNER:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",ADMIN:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",MANAGER:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",SALES:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},A={active:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",inactive:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},B=["OWNER","ADMIN","MANAGER","SALES"];function C({onEditUser:a,onDeleteUser:d}){let[e,g]=(0,c.useState)([]),[i,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(!0),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)("all"),{user:J}=(0,h.useAuth)(),K=(0,j.useRouter)();(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,k.getUsers)();g(a),C(a)}catch(a){console.error("[v0] Failed to fetch users:",a),y.toast.error("Failed to load users")}finally{E(!1)}})()},[]),(0,c.useEffect)(()=>{let a=[...e];if(F){let b=F.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b))}"all"!==H&&(a=a.filter(a=>a.role===H)),C(a)},[e,F,H]);let L=a=>!!J&&("OWNER"===J.role||"ADMIN"===J.role||"MANAGER"===J.role&&"SALES"===a.role),M=async(a,b)=>{try{await (0,k.updateUser)(a,{role:b}),g(c=>c.map(c=>c.id===a?{...c,role:b}:c)),y.toast.success("User role updated successfully")}catch(a){y.toast.error(a.message||"Failed to update role")}},N=a=>{K.push(`/users/${a}`)};return D?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-10 flex-1"}),(0,b.jsx)(p.Skeleton,{className:"h-10 w-32"})]}),(0,b.jsx)("div",{className:"rounded-lg border border-border/50 overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-border/50 bg-muted/30",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-16"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-12"})})]})}),(0,b.jsx)("tbody",{children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-border/50",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-32"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-40"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsx)(p.Skeleton,{className:"h-8 w-8 ml-auto"})})]},c))})]})})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(w.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(r.Input,{placeholder:"Search users...",value:F,onChange:a=>G(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(n.Select,{value:H,onValueChange:I,children:[(0,b.jsxs)(n.SelectTrigger,{className:"w-[160px]",children:[(0,b.jsx)(x.Filter,{className:"mr-2 h-4 w-4"}),(0,b.jsx)(n.SelectValue,{placeholder:"Role"})]}),(0,b.jsxs)(n.SelectContent,{children:[(0,b.jsx)(n.SelectItem,{value:"all",children:"All Roles"}),B.map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:a},a))]})]})]}),0===i.length?(0,b.jsx)("div",{className:"rounded-lg border border-border/50 border-dashed p-8 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:0===e.length?"No users found.":"No users match your filters."})}):(0,b.jsx)("div",{className:"rounded-lg border border-border/50 overflow-hidden",children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{className:"bg-muted/30",children:(0,b.jsxs)(l.TableRow,{className:"border-b border-border/50 hover:bg-muted/30",children:[(0,b.jsx)(l.TableHead,{children:"User"}),(0,b.jsx)(l.TableHead,{children:"Email"}),(0,b.jsx)(l.TableHead,{children:"Role"}),(0,b.jsx)(l.TableHead,{children:"Status"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Last Login"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(l.TableBody,{children:i.map(c=>(0,b.jsxs)(l.TableRow,{className:"border-b border-border/50 hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>L(c)&&N(c.id),children:[(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(q.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(q.AvatarFallback,{className:"text-xs font-bold",children:c.name.split(" ").map(a=>a[0]).join("").toUpperCase()})}),(0,b.jsx)("span",{className:"font-medium",children:c.name})]})}),(0,b.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:c.email}),(0,b.jsx)(l.TableCell,{onClick:a=>a.stopPropagation(),children:J&&J.id!==c.id&&("OWNER"===J.role||"ADMIN"===J.role)&&("ADMIN"!==J.role||"OWNER"!==c.role)&&1?(0,b.jsxs)(n.Select,{value:c.role,onValueChange:a=>M(c.id,a),children:[(0,b.jsx)(n.SelectTrigger,{className:"w-[120px] h-8",children:(0,b.jsx)(o.Badge,{variant:"outline",className:z[c.role]||"bg-gray-100",children:c.role})}),(0,b.jsx)(n.SelectContent,{children:(!J?[]:"OWNER"===J.role?["ADMIN","MANAGER","SALES"]:"ADMIN"===J.role?["MANAGER","SALES"]:[]).map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:(0,b.jsx)(o.Badge,{variant:"outline",className:z[a],children:a})},a))})]}):(0,b.jsx)(o.Badge,{variant:"outline",className:z[c.role]||"bg-gray-100",children:c.role})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(o.Badge,{variant:"outline",className:A[c.status]||"bg-gray-100",children:c.status})}),(0,b.jsx)(l.TableCell,{className:"text-right text-sm text-muted-foreground",children:c.lastLogin?new Date(c.lastLogin).toLocaleDateString():"Never"}),(0,b.jsx)(l.TableCell,{className:"text-right",onClick:a=>a.stopPropagation(),children:(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(s.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",children:[L(c)&&(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>N(c.id),children:[(0,b.jsx)(v.Eye,{className:"h-4 w-4 mr-2"}),"View Profile"]}),(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>a?.(c),children:[(0,b.jsx)(t.Edit2,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>d?.(c.id),className:"text-destructive",children:[(0,b.jsx)(u.Trash2,{className:"h-4 w-4 mr-2"}),"Deactivate"]})]})]})})]},c.id))})]})})]})}var D=a.i(65733),E=a.i(17171);let F=[{value:"SALES",label:"Sales User"},{value:"MANAGER",label:"Manager"},{value:"ADMIN",label:"Admin"}];function G({isOpen:a,onClose:d,onSuccess:e}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)({name:"",email:"",role:"SALES"}),k=a=>{let{name:b,value:c}=a.target;j(a=>({...a,[b]:c}))},l=async a=>{a.preventDefault(),h(!0);try{y.toast.success("User added successfully"),j({name:"",email:"",role:"SALES"}),d(),e?.()}catch(a){y.toast.error(a instanceof Error?a.message:"Failed to add user")}finally{h(!1)}};return(0,b.jsx)(D.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(D.DialogContent,{className:"max-w-md",children:[(0,b.jsx)(D.DialogHeader,{children:(0,b.jsx)(D.DialogTitle,{children:"Add Team Member"})}),(0,b.jsxs)("form",{onSubmit:l,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"name",children:"Full Name *"}),(0,b.jsx)(r.Input,{id:"name",name:"name",value:i.name,onChange:k,placeholder:"John Doe",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"email",children:"Email *"}),(0,b.jsx)(r.Input,{id:"email",name:"email",type:"email",value:i.email,onChange:k,placeholder:"john@example.com",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"role",children:"Role *"}),(0,b.jsxs)(n.Select,{value:i.role,onValueChange:a=>{j(b=>({...b,role:a}))},children:[(0,b.jsx)(n.SelectTrigger,{id:"role",children:(0,b.jsx)(n.SelectValue,{})}),(0,b.jsx)(n.SelectContent,{children:F.map(a=>(0,b.jsx)(n.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsx)("div",{className:"rounded-lg bg-muted/50 p-3 text-xs text-muted-foreground",children:"An invitation email will be sent to the user with login credentials."}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:d,children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:g,children:g?"Adding...":"Add User"})]})]})]})})}function H(){let{user:a}=(0,h.useAuth)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),n=async a=>{console.log("Delete user:",a)};return(0,b.jsx)(i.ProtectedRoute,{requiredRoles:["ADMIN"],children:(0,b.jsx)(d.AppLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Users & Roles"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Manage team members and their roles"})]}),(0,b.jsxs)(f.Button,{size:"lg",className:"gap-2",onClick:()=>k(!0),children:[(0,b.jsx)(g.Plus,{className:"h-4 w-4"}),"Add User"]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Team Members"})}),(0,b.jsx)("div",{className:"px-6 pb-6",children:(0,b.jsx)(C,{onEditUser:a=>{m(a)},onDeleteUser:n})})]}),(0,b.jsx)(G,{isOpen:j,onClose:()=>k(!1)})]})})})}a.s(["default",()=>H],70604)}];

//# sourceMappingURL=app_users_page_tsx_bc4a4b84._.js.map