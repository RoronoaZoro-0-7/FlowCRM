module.exports=[70604,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(48078),e=a.i(3130),f=a.i(40695),g=a.i(15618),h=a.i(38422),i=a.i(4667),j=a.i(50944),k=a.i(74808),l=a.i(88237),m=a.i(76504),n=a.i(87682),o=a.i(54161),p=a.i(50463),q=a.i(7706),r=a.i(5522),s=a.i(17755),t=a.i(10448),u=a.i(81560),v=a.i(77156),w=a.i(87532),x=a.i(81464),y=a.i(23292);let z={OWNER:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",ADMIN:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200",MANAGER:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",SALES:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},A={active:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",inactive:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"},B=["OWNER","ADMIN","MANAGER","SALES"];function C({onEditUser:a,onDeleteUser:d,refreshTrigger:e}){let[g,i]=(0,c.useState)([]),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)("all"),{user:K}=(0,h.useAuth)(),L=(0,j.useRouter)();(0,c.useEffect)(()=>{(async()=>{try{let a=await (0,k.getUsers)();i(a),D(a)}catch(a){console.error("[v0] Failed to fetch users:",a),y.toast.error("Failed to load users")}finally{F(!1)}})()},[e]),(0,c.useEffect)(()=>{let a=[...g];if(G){let b=G.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b))}"all"!==I&&(a=a.filter(a=>a.role===I)),D(a)},[g,G,I]);let M=a=>!!K&&("OWNER"===K.role||"ADMIN"===K.role||"MANAGER"===K.role&&"SALES"===a.role),N=async(a,b)=>{try{await (0,k.updateUser)(a,{role:b}),i(c=>c.map(c=>c.id===a?{...c,role:b}:c)),y.toast.success("User role updated successfully")}catch(a){y.toast.error(a.message||"Failed to update role")}},O=a=>{L.push(`/users/${a}`)};return E?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-4",children:[(0,b.jsx)(p.Skeleton,{className:"h-10 flex-1"}),(0,b.jsx)(p.Skeleton,{className:"h-10 w-32"})]}),(0,b.jsx)("div",{className:"rounded-lg border border-border/50 overflow-hidden",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-border/50 bg-muted/30",children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-left",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-16"})}),(0,b.jsx)("th",{className:"px-4 py-3 text-right",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-12"})})]})}),(0,b.jsx)("tbody",{children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-border/50",children:[(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-32"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-40"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-24"})}),(0,b.jsx)("td",{className:"px-4 py-3",children:(0,b.jsx)(p.Skeleton,{className:"h-4 w-20"})}),(0,b.jsx)("td",{className:"px-4 py-3 text-right",children:(0,b.jsx)(p.Skeleton,{className:"h-8 w-8 ml-auto"})})]},c))})]})})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(w.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(r.Input,{placeholder:"Search users...",value:G,onChange:a=>H(a.target.value),className:"pl-10"})]}),(0,b.jsxs)(n.Select,{value:I,onValueChange:J,children:[(0,b.jsxs)(n.SelectTrigger,{className:"w-[160px]",children:[(0,b.jsx)(x.Filter,{className:"mr-2 h-4 w-4"}),(0,b.jsx)(n.SelectValue,{placeholder:"Role"})]}),(0,b.jsxs)(n.SelectContent,{children:[(0,b.jsx)(n.SelectItem,{value:"all",children:"All Roles"}),B.map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:a},a))]})]})]}),0===C.length?(0,b.jsx)("div",{className:"rounded-lg border border-border/50 border-dashed p-8 text-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:0===g.length?"No users found.":"No users match your filters."})}):(0,b.jsx)("div",{className:"rounded-lg border border-border/50 overflow-hidden",children:(0,b.jsxs)(l.Table,{children:[(0,b.jsx)(l.TableHeader,{className:"bg-muted/30",children:(0,b.jsxs)(l.TableRow,{className:"border-b border-border/50 hover:bg-muted/30",children:[(0,b.jsx)(l.TableHead,{children:"User"}),(0,b.jsx)(l.TableHead,{children:"Email"}),K?.role==="OWNER"&&(0,b.jsx)(l.TableHead,{children:"Organization"}),(0,b.jsx)(l.TableHead,{children:"Role"}),(0,b.jsx)(l.TableHead,{children:"Status"}),(0,b.jsx)(l.TableHead,{className:"text-right",children:"Actions"})]})}),(0,b.jsx)(l.TableBody,{children:C.map(c=>(0,b.jsxs)(l.TableRow,{className:"border-b border-border/50 hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>M(c)&&O(c.id),children:[(0,b.jsx)(l.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(q.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(q.AvatarFallback,{className:"text-xs font-bold",children:c.name.split(" ").map(a=>a[0]).join("").toUpperCase()})}),(0,b.jsx)("span",{className:"font-medium",children:c.name})]})}),(0,b.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:c.email}),K?.role==="OWNER"&&(0,b.jsx)(l.TableCell,{className:"text-sm text-muted-foreground",children:c.organization?.name||"-"}),(0,b.jsx)(l.TableCell,{onClick:a=>a.stopPropagation(),children:K&&K.id!==c.id&&("OWNER"===K.role||"ADMIN"===K.role)&&("ADMIN"!==K.role||"OWNER"!==c.role)&&1?(0,b.jsxs)(n.Select,{value:c.role,onValueChange:a=>N(c.id,a),children:[(0,b.jsx)(n.SelectTrigger,{className:"w-[120px] h-8",children:(0,b.jsx)(o.Badge,{variant:"outline",className:z[c.role]||"bg-gray-100",children:c.role})}),(0,b.jsx)(n.SelectContent,{children:(!K?[]:"OWNER"===K.role?["ADMIN","MANAGER","SALES"]:"ADMIN"===K.role?["MANAGER","SALES"]:[]).map(a=>(0,b.jsx)(n.SelectItem,{value:a,children:(0,b.jsx)(o.Badge,{variant:"outline",className:z[a],children:a})},a))})]}):(0,b.jsx)(o.Badge,{variant:"outline",className:z[c.role]||"bg-gray-100",children:c.role})}),(0,b.jsx)(l.TableCell,{children:(0,b.jsx)(o.Badge,{variant:"outline",className:A[c.status]||"bg-gray-100",children:c.status})}),(0,b.jsx)(l.TableCell,{className:"text-right text-sm text-muted-foreground",children:c.lastLogin?new Date(c.lastLogin).toLocaleDateString():"Never"}),(0,b.jsx)(l.TableCell,{className:"text-right",onClick:a=>a.stopPropagation(),children:(0,b.jsxs)(m.DropdownMenu,{children:[(0,b.jsx)(m.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(s.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(m.DropdownMenuContent,{align:"end",children:[M(c)&&(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>O(c.id),children:[(0,b.jsx)(v.Eye,{className:"h-4 w-4 mr-2"}),"View Profile"]}),(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>a?.(c),children:[(0,b.jsx)(t.Edit2,{className:"h-4 w-4 mr-2"}),"Edit"]}),(0,b.jsxs)(m.DropdownMenuItem,{onClick:()=>d?.(c.id),className:"text-destructive",children:[(0,b.jsx)(u.Trash2,{className:"h-4 w-4 mr-2"}),"Deactivate"]})]})]})})]},c.id))})]})})]})}var D=a.i(65733),E=a.i(17171);let F=[{value:"SALES",label:"Sales User"},{value:"MANAGER",label:"Manager"},{value:"ADMIN",label:"Admin"}];function G({isOpen:a,onClose:d,onSuccess:e,editingUser:g}){let[h,i]=(0,c.useState)(!1),[j,l]=(0,c.useState)({name:"",email:"",role:"SALES"});(0,c.useEffect)(()=>{g?l({name:g.name,email:g.email,role:g.role}):l({name:"",email:"",role:"SALES"})},[g,a]);let m=a=>{let{name:b,value:c}=a.target;l(a=>({...a,[b]:c}))},o=async a=>{a.preventDefault(),i(!0);try{g?(await (0,k.updateUser)(g.id,{name:j.name,role:j.role}),y.toast.success("User updated successfully")):(await (0,k.createUser)(j),y.toast.success("User added successfully")),l({name:"",email:"",role:"SALES"}),d(),e?.()}catch(a){y.toast.error(a instanceof Error?a.message:g?"Failed to update user":"Failed to add user")}finally{i(!1)}};return(0,b.jsx)(D.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(D.DialogContent,{className:"max-w-md",children:[(0,b.jsx)(D.DialogHeader,{children:(0,b.jsx)(D.DialogTitle,{children:g?"Edit Team Member":"Add Team Member"})}),(0,b.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"name",children:"Full Name *"}),(0,b.jsx)(r.Input,{id:"name",name:"name",value:j.name,onChange:m,placeholder:"John Doe",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"email",children:"Email *"}),(0,b.jsx)(r.Input,{id:"email",name:"email",type:"email",value:j.email,onChange:m,placeholder:"john@example.com",required:!0,disabled:!!g})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(E.Label,{htmlFor:"role",children:"Role *"}),(0,b.jsxs)(n.Select,{value:j.role,onValueChange:a=>{l(b=>({...b,role:a}))},children:[(0,b.jsx)(n.SelectTrigger,{id:"role",children:(0,b.jsx)(n.SelectValue,{})}),(0,b.jsx)(n.SelectContent,{children:F.map(a=>(0,b.jsx)(n.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),!g&&(0,b.jsx)("div",{className:"rounded-lg bg-muted/50 p-3 text-xs text-muted-foreground",children:"An invitation email will be sent to the user with login credentials."}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:d,children:"Cancel"}),(0,b.jsx)(f.Button,{type:"submit",disabled:h,children:h?g?"Updating...":"Adding...":g?"Update User":"Add User"})]})]})]})})}function H(){let{user:a}=(0,h.useAuth)(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(0),p=async a=>{console.log("Delete user:",a)};return(0,b.jsx)(i.ProtectedRoute,{requiredRoles:["OWNER","ADMIN"],children:(0,b.jsx)(d.AppLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Users & Roles"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Manage team members and their roles"})]}),(0,b.jsxs)(f.Button,{size:"lg",className:"gap-2",onClick:()=>{m(null),k(!0)},children:[(0,b.jsx)(g.Plus,{className:"h-4 w-4"}),"Add User"]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Team Members"})}),(0,b.jsx)("div",{className:"px-6 pb-6",children:(0,b.jsx)(C,{onEditUser:a=>{m(a),k(!0)},onDeleteUser:p,refreshTrigger:n})})]}),(0,b.jsx)(G,{isOpen:j,onClose:()=>{k(!1),m(null)},onSuccess:()=>{o(a=>a+1)},editingUser:l})]})})})}a.s(["default",()=>H],70604)}];

//# sourceMappingURL=app_users_page_tsx_bc4a4b84._.js.map